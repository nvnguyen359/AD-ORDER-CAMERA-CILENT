<p-toast></p-toast>

<div class="surface-section p-4 md:p-6 lg:p-8">
  <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 max-w-full mx-auto pb-8">

    <div class="col-span-1">
      <p-card header="‚öôÔ∏è Camera & H√¨nh ·∫£nh" styleClass="h-full shadow-md">
        <form [formGroup]="settingForm" class="flex flex-col gap-5">

          <div class="flex flex-col gap-2">
            <label class="font-bold text-gray-700">ƒê·ªô ph√¢n gi·∫£i (Resolution)</label>
            <p-select
              [options]="resolutions"
              formControlName="resolution"
              optionLabel="label"
              optionValue="value"
              placeholder="Ch·ªçn ƒë·ªô ph√¢n gi·∫£i"
              styleClass="w-full"
              (onChange)="saveSettings()"> </p-select>
            <small class="text-blue-500"><i class="pi pi-info-circle"></i> 854x480 l√† m·ª©c m∆∞·ª£t nh·∫•t cho Orange Pi 3.</small>
          </div>

          <div class="flex flex-col gap-2">
            <label class="font-bold text-gray-700">Th∆∞ m·ª•c l∆∞u tr·ªØ</label>
            <input
              pInputText
              formControlName="save_media"
              placeholder="app/media"
              class="w-full"
              (blur)="saveSettings()" />
            <small class="text-gray-500">N∆°i l∆∞u Video/·∫¢nh tr√™n th·∫ª nh·ªõ.</small>
          </div>

        </form>
      </p-card>
    </div>

    <div class="col-span-1">
      <p-card header="ü§ñ V·∫≠n h√†nh & AI" styleClass="h-full shadow-md">
        <form [formGroup]="settingForm" class="flex flex-col gap-5">

          <div class="flex flex-col gap-2">
            <label class="font-bold text-gray-700">Timeout (T·ª± ng·∫Øt)</label>
            <p-select
              [options]="timeoutOptions"
              formControlName="timeout_no_human"
              optionLabel="label"
              optionValue="value"
              placeholder="Ch·ªçn th·ªùi gian ch·ªù"
              styleClass="w-full"
              (onChange)="saveSettings()"> </p-select>
            <small class="text-gray-500">T·ª± ƒë√≥ng ƒë∆°n n·∫øu Camera kh√¥ng th·∫•y ng∆∞·ªùi.</small>
          </div>

          <div class="flex flex-col gap-2">
             <label class="font-bold text-gray-700">Tr·ª£ l√Ω Gi·ªçng n√≥i (TTS)</label>
             <div class="flex align-items-center gap-3">
                <p-toggleswitch formControlName="enable_audio" (onChange)="saveSettings()"></p-toggleswitch>
                <span class="text-gray-600 font-medium" [class.text-green-600]="settingForm.get('enable_audio')?.value">
                   {{ settingForm.get('enable_audio')?.value ? 'ƒêang B·∫¨T üîä' : 'ƒêang T·∫ÆT üîá' }}
                </span>
             </div>
             <small class="text-gray-500">T·∫Øt ƒëi n·∫øu ch∆∞a c√†i driver √¢m thanh ƒë·ªÉ tr√°nh l·ªói.</small>
          </div>

          <div class="flex flex-col gap-2">
            <label class="font-bold text-gray-700">ƒê·ªô nh·∫°y AI (Confidence)</label>
            <p-select
              [options]="aiOptions"
              formControlName="ai_confidence"
              optionLabel="label"
              optionValue="value"
              placeholder="Ch·ªçn ƒë·ªô nh·∫°y"
              styleClass="w-full"
              (onChange)="saveSettings()"> </p-select>
          </div>

          <div class="flex flex-col gap-2">
             <label class="font-bold text-gray-700">ƒê·ªçc s·ªë cu·ªëi m√£ ƒë∆°n (TTS)</label>
             <div class="flex align-items-center gap-2">
                <input pInputText type="number" formControlName="read_end_order" class="w-4rem" min="3" max="10">
                <span class="text-gray-600">s·ªë cu·ªëi</span>
             </div>
             <small class="text-gray-500">V√≠ d·ª•: M√£ ...8829 -> ƒê·ªçc "Hai ch√≠n".</small>
          </div>

          <div class="flex flex-col gap-2">
            <label class="font-bold text-gray-700">Gi·ªù k·∫øt th√∫c ca</label>
            <input
              pInputText
              type="time"
              formControlName="work_end_time"
              class="w-full"
              (change)="saveSettings()" />
          </div>

        </form>
      </p-card>
    </div>

    <div class="col-span-1">
      <p-card header="üöÄ T·ªëi ∆∞u Hi·ªáu nƒÉng (Orange Pi)" styleClass="h-full shadow-md surface-50 border-blue-100 border-1">
        <form [formGroup]="settingForm" class="flex flex-col gap-5">

          <div class="flex flex-col gap-2">
            <label class="font-bold text-red-600">FPS Ghi h√¨nh (Record)</label>
            <p-select
              [options]="fpsOptions"
              formControlName="perf_record_fps"
              optionLabel="label"
              optionValue="value"
              styleClass="w-full"
              (onChange)="saveSettings()"></p-select>
            <small class="text-gray-500">Th·∫•p (10-12) gi√∫p CPU kh√¥ng b·ªã qu√° t·∫£i khi n√©n video.</small>
          </div>

          <div class="flex flex-col gap-2">
            <label class="font-bold text-blue-600">FPS Hi·ªÉn th·ªã (View)</label>
            <p-select
              [options]="fpsViewOptions"
              formControlName="perf_view_fps"
              optionLabel="label"
              optionValue="value"
              styleClass="w-full"
              (onChange)="saveSettings()"></p-select>
            <small class="text-gray-500">Gi·ªõi h·∫°n t·ªëc ƒë·ªô x·ª≠ l√Ω ·∫£nh ƒë·ªÉ m√°y m√°t h∆°n.</small>
          </div>

          <div class="flex flex-col gap-2">
            <label class="font-bold text-purple-600">T·∫ßn su·∫•t AI (Interval)</label>
            <div class="flex align-items-center gap-2">
               <span class="font-bold">M·ªói</span>
               <input pInputText type="number" formControlName="perf_ai_interval" class="w-5rem text-center" min="1" max="30">
               <span class="font-bold">frame qu√©t 1 l·∫ßn</span>
            </div>
            <small class="text-gray-500">
               TƒÉng s·ªë n√†y l√™n (vd: 12, 15) n·∫øu m√°y b·ªã lag.
               <br>12 = Qu√©t 2 l·∫ßn/gi√¢y.
            </small>
          </div>

        </form>
      </p-card>
    </div>

  </div>

  <div class="fixed bottom-0 left-0 w-full bg-white border-t border-gray-200 p-3 flex justify-center z-50 shadow-lg">
    <p-button
      label="L∆∞u T·∫•t C·∫£ C·∫•u H√¨nh"
      icon="pi pi-save"
      (onClick)="saveSettings()"
      [loading]="isLoading"
      styleClass="p-button-primary px-6 p-button-rounded font-bold">
    </p-button>
  </div>
</div>
